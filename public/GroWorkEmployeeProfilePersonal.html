<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Brooklyn Simmons - Employee Profile | GroWork HR Management</title>
  <meta name="description" content="View and manage Brooklyn Simmons' employee profile including personal information, job details, contact information, and professional data in GroWork HR system.">
  <meta name="keywords" content="employee profile, HR management, staff information, employee details, GroWork">
  <style>
    /* =========================
       Original styles preserved
       ========================= */
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:Inter, -apple-system, BlinkMacSystemFont, sans-serif;background:#f9f9fc;color:#16141b;line-height:1.5}
    .main-container{display:flex;flex-direction:column;min-height:100vh;width:100%}
    .sidebar{display:none;background:rgba(162,161,168,0.05);width:240px;min-height:100vh;padding:30px 14px;position:fixed;left:0;top:0;z-index:100}
    .sidebar-logo{width:162px;height:50px;margin-left:16px;margin-bottom:42px}
    .sidebar-menu{display:flex;flex-direction:column;gap:10px;margin-left:16px}
    .menu-item{display:flex;align-items:center;padding:12px;border-radius:8px;transition:all .3s ease;cursor:pointer}
    .menu-item:hover{background:rgba(113,82,243,0.1)}
    .menu-item img{width:24px;height:24px;margin-left:6px}
    .menu-text{font-size:16px;font-weight:500;line-height:20px;color:#16141b;margin-left:16px}
    .content-area{flex:1;margin-left:0}
    .header{background:#7152f3;padding:26px 24px}
    .header-content{display:flex;flex-direction:column;gap:30px}
    .header-top{display:flex;flex-direction:column;gap:32px}
    .search-container{flex:1;position:relative}
    .search-input{width:600px;padding:8px 10px 8px 42px;border:none;border-radius:8px;background:#fff;font-size:14px;color:#2e2d33;box-shadow:5px 1px 35px rgba(168,133,229,0.5);outline:none}
    .search-icon{position:absolute;left:12px;top:50%;transform:translateY(-50%);width:24px;height:24px}
    .header-actions{display:flex;align-items:center;gap:16px}
    .notification-badge{position:relative}
    .notification-count{position:absolute;top:-4px;right:-4px;background:#3ee051;color:#fff;font-size:10px;font-weight:600;line-height:13px;padding:2px 6px;border-radius:8px;min-width:18px;text-align:center}
    .notification-icon{width:18px;height:18px}
    .user-dropdown{display:flex;align-items:center;gap:12px;padding:8px;cursor:pointer}
    .user-avatar{width:32px;height:32px;border-radius:50%}
    .user-name{font-size:14px;font-weight:500;color:#fff}
    .dropdown-icon{width:24px;height:24px}
    .page-header{padding:0 26px 76px}
    .page-title{font-size:32px;font-weight:500;line-height:39px;color:#fff;margin-bottom:10px}
    .breadcrumb{display:flex;align-items:center;gap:14px}
    .breadcrumb-link{font-size:18px;font-weight:400;color:#d9e1e1;text-decoration:none}
    .main-content{background:#fff;border:1px solid rgba(162,161,168,0.2);border-radius:10px;margin:-48px 48px 0;padding:20px}
    .profile-header{display:flex;flex-direction:column;gap:30px;padding:0 20px}
    .profile-info{display:flex;flex-direction:column;gap:16px;align-items:center}
    .profile-avatar{width:100px;height:100px;border-radius:10px;object-fit:cover}
    .profile-details{text-align:center}
    .profile-name{font-size:24px;font-weight:600;line-height:30px;color:#16141b;margin-bottom:6px}
    .profile-role{display:flex;align-items:center;justify-content:center;gap:10px;margin-bottom:6px;position:relative;left:-335px}
    .profile-role img{width:24px;height:24px}
    .role-text{font-size:16px;font-weight:300;color:#16141b}
    .profile-email{display:flex;align-items:center;justify-content:center;gap:10px;position:relative;left:-301px}
    .profile-email img{width:24px;height:24px}
    .email-text{font-size:16px;font-weight:300;color:#16141b}
    .edit-button{background:#7152f3;color:#fff;border:none;border-radius:10px;padding:12px 20px 12px 54px;font-size:16px;font-weight:300;line-height:20px;cursor:pointer;position:relative;align-self:center;transition:all .3s ease}
    .edit-button:hover{background:#5d42d1;transform:translateY(-2px)}
    .divider{width:100%;height:1px;background:rgba(162,161,168,0.2);margin:30px 0}
    .content-section{display:flex;flex-direction:column;gap:30px;padding:0 20px}
    .sidebar-tabs{width:100%;border:1px solid rgba(162,161,168,0.2);border-radius:10px;overflow:hidden}
    .tab-item{display:flex;align-items:center;padding:16px 20px;cursor:pointer;transition:all .3s ease}
    .tab-item.active{background:#7152f3;border-radius:10px 10px 0 0}
    .tab-item.active .tab-text{color:#fff;font-weight:600}
    .tab-item img{width:24px;height:24px}
    .tab-text{font-size:16px;font-weight:300;color:#16141b;margin-left:10px}
    .profile-content{flex:1}
    .tab-navigation{display:flex;flex-direction:column;gap:20px;margin-bottom:20px}
    .tab-header{display:flex;flex-direction:column;gap:8px}
    .tab-links{display:flex;flex-wrap:wrap;gap:20px}
    .tab-link{display:flex;align-items:center;gap:10px;text-decoration:none;cursor:pointer;padding:8px 0}
    .tab-link.active{color:#7152f3;font-weight:600}
    .tab-link img{width:24px;height:24px}
    .tab-link-text{font-size:16px;font-weight:300;color:#16141b}
    .tab-link.active .tab-link-text{color:#7152f3;font-weight:600}
    .tab-underline{height:3px;background:#7152f3;width:206px;margin-top:8px}
    .tab-divider{height:1px;background:rgba(162,161,168,0.2);width:100%;margin-top:-2px}
    .form-section{display:flex;flex-direction:column;gap:18px}
    .form-row{display:flex;flex-direction:column;gap:20px}
    .form-group{display:flex;flex-direction:column;gap:8px;flex:1}
    .form-label{font-size:14px;font-weight:300;color:#a1a0a7}
    .form-input{padding:10px;border:none;border-bottom:1px solid rgba(162,161,168,0.1);background:transparent;font-size:16px;font-weight:300;color:#16141b;outline:none}
    .form-input:focus{border-bottom-color:#7152f3}
    .form-text{font-size:16px;font-weight:300;color:#16141b;padding:10px 0;border-bottom:1px solid rgba(162,161,168,0.1)}
    .hamburger{display:block;position:fixed;top:20px;left:20px;z-index:200;background:#7152f3;border:none;padding:8px;border-radius:4px;cursor:pointer}
    .hamburger span{display:block;width:20px;height:2px;background:#fff;margin:3px 0;transition:0.3s}
    @media(min-width:640px){.form-row{flex-direction:row}.form-group{margin-right:20px}.form-group:last-child{margin-right:0}.profile-info{flex-direction:row;align-items:flex-start}.profile-details{text-align:left;flex:1}.edit-button{align-self:flex-end}.tab-links{flex-wrap:nowrap}}
    @media(min-width:768px){.header-top{flex-direction:row;align-items:center}.main-content{margin:-48px 48px 0}.content-section{flex-direction:row;align-items:flex-start}.sidebar-tabs{width:24%;margin-right:30px}.profile-content{width:76%}}
    @media(min-width:1024px){.sidebar{display:block}.content-area{margin-left:240px}.hamburger{display:none}.main-container{flex-direction:row}.page-title{font-size:32px}.profile-name{font-size:24px}}
    @media(min-width:1280px){.header{padding:26px 24px}.main-content{margin:-48px 48px 0}}
    /* toast */
    .toast{position:fixed;right:20px;bottom:20px;background:rgba(20,20,20,0.95);color:#fff;padding:10px 14px;border-radius:8px;font-size:14px;opacity:0;transform:translateY(8px);transition:opacity .18s,transform .18s;z-index:2000}
    .toast.show{opacity:1;transform:none}
    /* small invalid style for inline editing */
    .invalid{border-bottom-color:#ef4444!important;box-shadow:0 1px 0 0 rgba(239,68,68,0.06)}
  </style>
</head>
<body>
  <button class="hamburger" id="hamburger" aria-expanded="false" aria-label="Toggle sidebar">
    <span></span><span></span><span></span>
  </button>

  <div class="main-container">
    <aside class="sidebar" id="sidebar" aria-hidden="false">
      <img src="assets/Logo.png" alt="GroWork Logo" class="sidebar-logo">
      <nav class="sidebar-menu" role="navigation" aria-label="Main menu">
        <div class="menu-item" data-menu="dashboard" tabindex="0" role="button"><img src="assets/Dashboard Icon.png" alt=""><span class="menu-text">Dashboard</span></div>
        <div class="menu-item active" data-menu="employees" tabindex="0" role="button"><img src="assets/All Employees.png" alt=""><span class="menu-text">All Employees</span></div>
        <div class="menu-item" data-menu="departments" tabindex="0" role="button"><img src="assets/All Departments.png" alt=""><span class="menu-text">All Departments</span></div>
        <div class="menu-item" data-menu="attendance" tabindex="0" role="button"><img src="assets/Attendance.png" alt=""><span class="menu-text">Attendance</span></div>
        <div class="menu-item" data-menu="payroll" tabindex="0" role="button"><img src="assets/Payroll.png" alt=""><span class="menu-text">Payroll</span></div>
        <div class="menu-item" data-menu="jobs" tabindex="0" role="button"><img src="assets/Jobs.png" alt=""><span class="menu-text">Jobs</span></div>
        <div class="menu-item" data-menu="candidates" tabindex="0" role="button"><img src="assets/Candidates.png" alt=""><span class="menu-text">Candidates</span></div>
        <div class="menu-item" data-menu="leaves" tabindex="0" role="button"><img src="assets/Leaves.png" alt=""><span class="menu-text">Leaves</span></div>
        <div class="menu-item" data-menu="holidays" tabindex="0" role="button"><img src="assets/Holiday.png" alt=""><span class="menu-text">Holidays</span></div>
        <div class="menu-item" data-menu="settings" tabindex="0" role="button"><img src="assets/Setting.png" alt=""><span class="menu-text">Settings</span></div>
      </nav>
    </aside>

    <main class="content-area" id="contentArea">
      <header class="header" role="banner">
        <div class="header-content">
          <div class="header-top">
            <div class="search-container">
              <img src="assets/Search.png" alt="" class="search-icon" aria-hidden="true">
              <input id="searchInput" class="search-input" type="text" placeholder="Search" aria-label="Search employees">
            </div>
            <div class="header-actions" role="group" aria-label="Header actions">
              <div class="notification-badge" title="Messages">
                <span class="notification-count" aria-hidden="true">2</span>
                <img src="assets/Email.png" alt="Messages" class="notification-icon">
              </div>
              <div class="notification-badge" title="Notifications">
                <span class="notification-count" aria-hidden="true">2</span>
                <img src="assets/Notification.png" alt="Notifications" class="notification-icon">
              </div>
              <img src="assets/Country.png" alt="Country" style="width:40px;height:40px">
              <div style="width:1px;height:40px;background:#4a4c56"></div>
              <div class="user-dropdown" role="button" tabindex="0" aria-haspopup="true" aria-expanded="false">
                <img src="assets/Profile.png" alt="Jay Hargudson" class="user-avatar">
                <span class="user-name">Jay Hargudson</span>
                <img src="assets/Arrow Down.png" alt="" class="dropdown-icon">
              </div>
            </div>
          </div>

          <div class="page-header">
            <h1 class="page-title">All Employees</h1>
            <nav class="breadcrumb" aria-label="Breadcrumb">
              <a href="#" class="breadcrumb-link">All Employees</a>
              <img src="assets/direaction right.png" alt="">
              <span class="breadcrumb-link">Brooklyn Simmons</span>
            </nav>
          </div>
        </div>
      </header>

      <section class="main-content" aria-labelledby="profileHeading">
        <div class="profile-header">
          <div class="profile-info" style="align-items:flex-start;">
            <img src="assets/Pict Profile.png" alt="Brooklyn Simmons" class="profile-avatar" id="profileAvatar">

            <div class="profile-details">
              <h2 class="profile-name" id="profileName">Brooklyn Simmons</h2>

              <div class="profile-role" title="Job role">
                <img src="assets/business.png" alt="">
                <span class="role-text" id="profileRole">Project Manager</span>
              </div>

              <div class="profile-email" title="Email address">
                <img src="assets/Gmail.png" alt="">
                <span class="email-text" id="profileEmail">brooklyn.s@example.com</span>
              </div>
            </div>

            <!-- Edit button will be swapped with Save/Cancel while editing -->
            <div style="margin-left:auto;display:flex;gap:12px;align-items:flex-start">
              <button id="editBtn" class="edit-button" aria-label="Edit profile">Edit Profile</button>
            </div>
          </div>

          <div class="divider"></div>
        </div>

        <div class="content-section">
          <div class="sidebar-tabs" role="navigation" aria-label="Profile navigation">
            <div class="tab-item active" data-side="profile" tabindex="0" role="button">
              <img src="assets/user 1.png" alt="">
              <span class="tab-text">Profile</span>
            </div>
            <div class="tab-item" data-side="attendance" tabindex="0" role="button">
              <img src="assets/Attendance.png" alt="">
              <span class="tab-text">Attendance</span>
            </div>
            <div class="tab-item" data-side="projects" tabindex="0" role="button">
              <img src="assets/Project.png" alt="">
              <span class="tab-text">Projects</span>
            </div>
            <div class="tab-item" data-side="leave" tabindex="0" role="button">
              <img src="assets/Leaves.png" alt="">
              <span class="tab-text">Leave</span>
            </div>
          </div>

          <div class="profile-content" id="profileContent">
            <div class="tab-navigation">
              <div class="tab-header">
                <div class="tab-links" role="tablist">
                  <a href="#" class="tab-link active" data-tab="personal" role="tab" aria-selected="true">
                    <img src="assets/user 2.png" alt=""><span class="tab-link-text">Personal Information</span>
                  </a>
                  <a href="GroWorkAddInformationEmployeeDashboard.html" class="tab-link" data-tab="professional" role="tab" aria-selected="false">
                    <img src="assets/business.png" alt=""><span class="tab-link-text">Professional Information</span>
                  </a>
                  <a href="GroWorkEmployeeDocumentsUpload" class="tab-link" data-tab="documents" role="tab" aria-selected="false">
                    <img src="assets/document-text.png" alt=""><span class="tab-link-text">Documents</span>
                  </a>
                  <a href="#" class="tab-link" data-tab="access" role="tab" aria-selected="false">
                    <img src="assets/padlock.png" alt=""><span class="tab-link-text">Account Access</span>
                  </a>
                </div>
                <div class="tab-underline" aria-hidden="true"></div>
                <div class="tab-divider" aria-hidden="true"></div>
              </div>
            </div>

            <!-- Content panes (only Personal shown by default) -->
            <div class="form-section" id="panes">
              <!-- PERSONAL -->
              <div class="pane" data-pane="personal">
                <div class="form-row">
                  <div class="form-group">
                    <label class="form-label" for="firstName">First Name</label>
                    <input id="firstName" class="form-input editable" type="text" value="Brooklyn" readonly>
                  </div>
                  <div class="form-group">
                    <label class="form-label" for="lastName">Last Name</label>
                    <input id="lastName" class="form-input editable" type="text" value="Simmons" readonly>
                  </div>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label class="form-label" for="mobile">Mobile Number</label>
                    <input id="mobile" class="form-input editable" type="tel" value="(702) 555-0122" readonly>
                  </div>
                  <div class="form-group">
                    <label class="form-label" for="email">Email Address</label>
                    <input id="email" class="form-input editable" type="email" value="brooklyn.s@example.com" readonly>
                  </div>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label class="form-label" for="dob">Date of Birth</label>
                    <input id="dob" class="form-input editable" type="date" value="1995-07-14" readonly>
                  </div>
                  <div class="form-group">
                    <label class="form-label" for="marital">Marital Status</label>
                    <input id="marital" class="form-input editable" type="text" value="Married" readonly>
                  </div>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label class="form-label" for="gender">Gender</label>
                    <input id="gender" class="form-input editable" type="text" value="Female" readonly>
                  </div>
                  <div class="form-group">
                    <label class="form-label" for="nationality">Nationality</label>
                    <input id="nationality" class="form-input editable" type="text" value="America" readonly>
                  </div>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label class="form-label" for="address">Address</label>
                    <input id="address" class="form-input editable" type="text" value="2464 Royal Ln. Mesa, New Jersey" readonly>
                  </div>
                  <div class="form-group">
                    <label class="form-label" for="city">City</label>
                    <input id="city" class="form-input editable" type="text" value="California" readonly>
                  </div>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label class="form-label" for="state">State</label>
                    <input id="state" class="form-input editable" type="text" value="United State" readonly>
                  </div>
                  <div class="form-group">
                    <label class="form-label" for="zip">Zip Code</label>
                    <input id="zip" class="form-input editable" type="text" value="35624" readonly>
                  </div>
                </div>
              </div>

              <!-- PROFESSIONAL -->
              <div class="pane" data-pane="professional" style="display:none">
                <div class="form-row">
                  <div class="form-group">
                    <label class="form-label" for="jobTitle">Job Title</label>
                    <input id="jobTitle" class="form-input editable" type="text" value="Project Manager" readonly>
                  </div>
                  <div class="form-group">
                    <label class="form-label" for="department">Department</label>
                    <input id="department" class="form-input editable" type="text" value="Operations" readonly>
                  </div>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label class="form-label" for="employeeId">Employee ID</label>
                    <input id="employeeId" class="form-input editable" type="text" value="EMP-2345" readonly>
                  </div>
                  <div class="form-group">
                    <label class="form-label" for="joined">Joining Date</label>
                    <input id="joined" class="form-input editable" type="date" value="2020-04-01" readonly>
                  </div>
                </div>
              </div>

              <!-- DOCUMENTS (placeholder) -->
              <div class="pane" data-pane="documents" style="display:none">
                <p style="padding:8px 0;color:#6b6b6b">Documents section — upload & preview can be added here.</p>
              </div>

              <!-- ACCOUNT ACCESS (placeholder) -->
              <div class="pane" data-pane="access" style="display:none">
                <p style="padding:8px 0;color:#6b6b6b">Account access settings (username, roles, password reset).</p>
              </div>
            </div>

            <!-- Save / Cancel area (appears when editing) -->
            <div id="editControls" style="display:none;margin-top:12px;display:flex;justify-content:flex-end;gap:12px">
              <button id="cancelEdit" class="edit-button" style="background:#fff;color:#16141b;border:1px solid rgba(162,161,168,0.2)">Cancel</button>
              <button id="saveEdit" class="edit-button" style="background:#6f4be6">Save</button>
            </div>

          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Toast -->
  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script>
    (function () {
      // Helpers
      const $ = s => document.querySelector(s);
      const $$ = s => Array.from(document.querySelectorAll(s));
      const toast = $('#toast');
      function showToast(msg, ms = 2200) {
        toast.textContent = msg;
        toast.classList.add('show');
        setTimeout(()=> toast.classList.remove('show'), ms);
      }

      // Sidebar toggle
      const hamburger = $('#hamburger');
      const sidebar = $('#sidebar');
      const contentArea = $('#contentArea');

      function openSidebar() {
        sidebar.style.display = 'block';
        contentArea.style.marginLeft = '240px';
        hamburger.setAttribute('aria-expanded','true');
      }
      function closeSidebar() {
        sidebar.style.display = '';
        contentArea.style.marginLeft = '';
        hamburger.setAttribute('aria-expanded','false');
      }
      hamburger.addEventListener('click', () => {
        if (window.getComputedStyle(sidebar).display === 'block') closeSidebar(); else openSidebar();
      });

      // Menu item activation (keyboard friendly)
      $$('.menu-item').forEach(mi => {
        mi.addEventListener('click', () => {
          $$('.menu-item').forEach(m => m.classList.remove('active'));
          mi.classList.add('active');
        });
        mi.addEventListener('keydown', (e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); mi.click(); }});
      });

      // Side tabs
      $$('.tab-item').forEach(t => {
        t.addEventListener('click', () => {
          $$('.tab-item').forEach(x => x.classList.remove('active'));
          t.classList.add('active');
          // for demo, no content change beyond highlight
        });
        t.addEventListener('keydown', (e) => { if (e.key==='Enter' || e.key===' ') { e.preventDefault(); t.click(); }});
      });

      // Top tab links -> show panes
      // Top tab links -> show panes
const tabLinks = $$('.tab-link');
const panes = $$('.pane');

function showPane(name) {
  panes.forEach(p => { p.style.display = (p.getAttribute('data-pane') === name) ? '' : 'none'; });
  tabLinks.forEach(link => {
    if (link.dataset.tab === name) { link.classList.add('active'); link.setAttribute('aria-selected','true'); } 
    else { link.classList.remove('active'); link.setAttribute('aria-selected','false'); }
  });
}

tabLinks.forEach(link => {
  link.addEventListener('click', function(e) {
    const href = link.getAttribute('href');

    // Jika link memiliki href nyata (bukan '#' atau kosong), biarkan browser navigasi
    if (href && href.trim() !== '' && href.trim() !== '#') {
      // Optional: save draft here if you want before navigating
      // saveDraftIfNeeded();
      return; // don't preventDefault -> browser will go to href
    }

    // Jika internal tab (href absent / '#'), cegah default dan tampilkan pane
    e.preventDefault();
    showPane(link.dataset.tab);
  });

  // keyboard accessibility: Enter/Space trigger click
  link.addEventListener('keydown', function(e) {
    if (e.key === 'Enter' || e.key === ' ') {
      e.preventDefault();
      this.click();
    }
  });
});


      // Edit flow
      const editBtn = $('#editBtn');
      const editControls = $('#editControls');
      const saveBtn = $('#saveEdit');
      const cancelBtn = $('#cancelEdit');
      const editableFields = $$('.editable');

      // Make fields readonly by default (they already are). We'll toggle attribute "readonly".
      function setEditable(on) {
        editableFields.forEach(f => {
          if (on) {
            f.removeAttribute('readonly');
            f.classList.remove('invalid');
            f.style.background = '';
          } else {
            f.setAttribute('readonly','');
            f.classList.remove('invalid');
          }
        });
        editControls.style.display = on ? 'flex' : 'none';
        // swap primary edit button visibility
        editBtn.style.display = on ? 'none' : '';
      }

      // Autosave draft while editing (debounced)
      let autosaveTimer = null;
      function autosave() {
        if (autosaveTimer) clearTimeout(autosaveTimer);
        autosaveTimer = setTimeout(() => {
          const data = {};
          editableFields.forEach(f => data[f.id] = f.value || '');
          localStorage.setItem('growork.profile.draft', JSON.stringify(data));
        }, 300);
      }

      // Restore draft if present
      (function restoreDraft(){
        try {
          const raw = localStorage.getItem('growork.profile.draft');
          if (!raw) return;
          const data = JSON.parse(raw);
          editableFields.forEach(f => { if (data[f.id] !== undefined) f.value = data[f.id]; });
          // let user decide to edit
          if (Object.keys(data).length) showToast('Draft restored');
        } catch (e) {}
      })();

      // Validation helpers
      function isEmail(v){ return /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/i.test(v); }
      function isFutureDate(v){ if(!v) return false; const d=new Date(v); d.setHours(0,0,0,0); const t=new Date(); t.setHours(0,0,0,0); return d>t; }

      function validateAll() {
        let ok = true;
        // minimal validation: firstName, lastName, email valid, dob not future
        const first = $('#firstName'), last = $('#lastName'), email = $('#email'), dob = $('#dob');
        [first,last,email,dob].forEach(el => el && el.classList.remove('invalid'));
        if (!first.value.trim()) { first.classList.add('invalid'); ok = false; }
        if (!last.value.trim())  { last.classList.add('invalid'); ok = false; }
        if (!email.value.trim() || !isEmail(email.value.trim())) { email.classList.add('invalid'); ok = false; }
        if (dob.value && isFutureDate(dob.value)) { dob.classList.add('invalid'); ok = false; }
        return ok;
      }

      // When edit pressed
      editBtn.addEventListener('click', () => {
        setEditable(true);
        // focus first field
        const first = $('#firstName'); if (first) first.focus();
      });

      // Cancel editing: restore from last saved values (not draft) or from draft prompt; for simplicity we'll reload from original static values
      cancelBtn.addEventListener('click', () => {
        // revert to initial values (we can store initial snapshot on load)
        if (window._initialProfile) {
          Object.keys(window._initialProfile).forEach(k => {
            const el = document.getElementById(k);
            if (el) el.value = window._initialProfile[k];
          });
        }
        setEditable(false);
        try { localStorage.removeItem('growork.profile.draft'); } catch(e){}
        showToast('Edit cancelled');
      });

      // Save: validate, mock save via fetch, then lock fields and update header info
      saveBtn.addEventListener('click', async () => {
        if (!validateAll()) { showToast('Please correct highlighted fields'); return; }
        // build payload
        const payload = {};
        editableFields.forEach(f => payload[f.id] = f.value || '');
        // UI
        saveBtn.disabled = true; saveBtn.textContent = 'Saving...';
        try {
          // Replace with your API endpoint if needed
          const res = await fetch('https://jsonplaceholder.typicode.com/posts', {
            method:'POST',
            headers:{'Content-Type':'application/json'},
            body: JSON.stringify(payload)
          });
          if (!res.ok) throw new Error('Save failed');

          // on success: update header (name, role, email)
          const name = (payload.firstName||'') + (payload.lastName? ' '+payload.lastName:'');
          if (name.trim()) $('#profileName').textContent = name;
          if (payload.jobTitle) $('#profileRole').textContent = payload.jobTitle;
          if (payload.email) $('#profileEmail').textContent = payload.email;

          // clear draft
          try { localStorage.removeItem('growork.profile.draft'); } catch(e){}

          setEditable(false);
          showToast('Profile saved');
        } catch (err) {
          showToast('Failed to save — try again');
        } finally {
          saveBtn.disabled = false; saveBtn.textContent = 'Save';
        }
      });

      // Save initial snapshot so cancel can revert
      (function snapshotInitial() {
        window._initialProfile = {};
        editableFields.forEach(f => { window._initialProfile[f.id] = f.value || ''; });
      })();

      // Make fields autosave when edited
      editableFields.forEach(f => {
        f.addEventListener('input', () => {
          if (f.classList.contains('invalid')) f.classList.remove('invalid');
          autosave();
        });
      });

      // Keyboard: Escape cancels editing
      window.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && editControls.style.display === 'flex') {
          cancelBtn.click();
        }
      });

      // Prevent accidental Enter submission (no form)
      $$('.form-input').forEach(inp => inp.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') e.preventDefault();
      }));

      // Tabs: show panes by data-tab attribute (already wired earlier)
      // We've implemented showPane logic via click handlers above; ensure first pane visible
      // (already defaulted to personal)

      // Basic search handler (non-blocking)
      $('#searchInput').addEventListener('keydown', function(e){
        if (e.key === 'Enter') { e.preventDefault(); const q = this.value.trim(); if (q) showToast('Search: '+q); }
      });

      // Make sidebar visible on wide screens (initial)
      if (window.innerWidth >= 1024) { sidebar.style.display = 'block'; contentArea.style.marginLeft = '240px'; }
      window.addEventListener('resize', () => {
        if (window.innerWidth >= 1024) { sidebar.style.display = 'block'; contentArea.style.marginLeft = '240px'; } 
        else { sidebar.style.display = ''; contentArea.style.marginLeft = ''; }
      });

      // Accessibility: allow tab activation via Enter for top tab links
      $$('.tab-link').forEach(link => link.addEventListener('keydown', (e)=>{ if (e.key==='Enter'||e.key===' ') { e.preventDefault(); link.click(); }}));

      // small enhancement: clicking profile avatar opens file picker to preview (optional)
      const avatar = $('#profileAvatar');
      if (avatar) {
        avatar.style.cursor = 'pointer';
        avatar.title = 'Click to change (preview only)';
        avatar.addEventListener('click', () => {
          const input = document.createElement('input');
          input.type = 'file'; input.accept = 'image/*';
          input.onchange = () => {
            const file = input.files && input.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (ev) => { avatar.src = ev.target.result; showToast('Avatar preview updated (not uploaded)'); };
            reader.readAsDataURL(file);
          };
          input.click();
        });
      }
    })();
  </script>
</body>
</html>
